(function(){var e={68246:function(e,t,s){"use strict";var a=s(36369),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},o=[],n={name:"App",components:{},created(){},mounted(){}},l=n,i=s(1001),u=(0,i.Z)(l,r,o,!1,null,null,null),c=u.exports,d=s(8499),m=s.n(d),h=s(15792);s(34457);let p={install:function(e){e.directive("highlightA",{inserted:function(e){let t=e.querySelectorAll("pre code");for(let s=0;s<t.length;s++){const e=t[s];h.Z.highlightBlock(e)}}}),e.directive("highlightB",{componentUpdated:function(e){let t=e.querySelectorAll("pre code");for(let s=0;s<t.length;s++){const e=t[s];h.Z.highlightBlock(e)}}})}};var g=p,f=s(76818),v=s.n(f),b=(s(57658),s(44161)),y=`http://${location.host}/api`;const k=y;var w=s(63822);const _="/user",x={getInfo:`${_}/get/usinfo`,sysLogin:`${_}/login`,sysLogout:`${_}/logout`,userUpdatePassword:`${_}/update/resetpassword`,userUpdateMessage:`${_}/update`,userUpdateAdmin:`${_}/update`,userRegister:`${_}/register`,userAdd:`${_}/add`,getUserById:`${_}/get?id:`,getUserAccountbyID:`${_}/get/userAccount?id:`,getUserNamebyID:`${_}/get/userName?id:`,getUserslistPage:`${_}/list/page`,deleteUser:`${_}/delete`,getUserVOByUserAccount:e=>Ps.get(`/user/get/vo/${e}`),exportUser:e=>Ps.post("/user/operate/export",e,{responseType:"blob"}),importUser:e=>Ps.post("/user/operate/import",e),getPbs:()=>Ps.get("/user/pbs"),getUUID:e=>Ps.post("/user/uuid",e)};var C=s(48082),S=s.n(C),$=s(66681),T={signByRequest(e,t){let s=null;return s=1===(1&parseInt(e.length))?e.toString()+t.toString():t.toString()+e.toString(),S().MD5("localhost"+s+"127.0.0.1").toString()},AesEncrypt(e,t){var s=S().enc.Utf8.parse(t),a=S().AES.encrypt(e,s,{mode:S().mode.ECB,padding:S().pad.Pkcs7});return S().enc.Base64.stringify(a.ciphertext)},AesDecrypt(e,t){t=t||null;var s=S().enc.Utf8.parse(t),a=S().AES.decrypt(e,s,{mode:S().mode.ECB,padding:S().pad.Pkcs7});return S().enc.Utf8.stringify(a).toString()},RSAEncrypt(e,t){var s=new $.X;return s.setPublicKey(t),s.encrypt(e)}},O=s(7335),A=s.n(O);const I={state:{uuid:"",token:"",name:"",roles:{admin:"管理员",user:"用户",dev:"开发者",ban:"封禁用户"},genders:["未知","男","女"],info:{},hexMsg:""},mutations:{SET_UUID:(e,t)=>{e.uuid=t},SET_TOKEN:(e,t)=>{e.token=t},SET_NAME:(e,{name:t,welcome:s})=>{e.name=t,e.welcome=s},SET_AVATAR:(e,t)=>{e.avatar=t},SET_ROLES:(e,t)=>{e.roles=t},SET_INFO:(e,t)=>{e.info=t},SET_HEXMSG:(e,t)=>{e.hexMsg=t}},actions:{setToken({commit:e},t=null){e("SET_TOKEN",t)},getUUIDputState({commit:e}){return new Promise(((t,s)=>{x.getPbs().then((s=>{if(!s.data.code){var r=s.data.data,o=A().hash(s.data.data+Math.random()).substr(0,16),n=T.RSAEncrypt(o,r);x.getUUID({pub:r,hexMsg:n}).then((s=>{e("SET_UUID",s.data.data),e("SET_HEXMSG",o),a["default"].prototype.axios.defaults.headers.common["Uuid"]=s.data.data,t(s)}))}})).catch((e=>{s(e)}))}))},getINFOputState({commit:e}){return new Promise(((t,s)=>{a["default"].prototype.axios.get(x.getInfo).then((s=>{e("SET_INFO",s.data.data),t(s)})).catch((e=>{s(e)}))}))}},getters:{getInfo(e){return e.info}}};var F=I,R=s(81639),P=s.n(R),E=s(1965),U=s.n(E);P().addPlugin(U());const B={state:{nodes:[{}],edges:[{}]}};var N=B,D=s(42415);a["default"].use(w.ZP);var L=new w.ZP.Store({modules:{user:F,role:N},state:{},mutations:{},actions:{},plugins:[(0,D.Z)({storage:window.localStorage,key:"store",render(e){return{...e}}})]});s(46229),s(17330),s(62062);const M="/site",Z={getAttributeListByCommon:M+"/attribute/list",getValueListByCommon:M+"/value/list",getCommonList:M+"/list",saveCommon:M+"/save",getAttributeByCommon:M+"/get?attribute="};var z=null;let V={protectTitle(){if(null!=z)return z;var e=new XMLHttpRequest;return e.open("GET",k+Z.getAttributeByCommon+"siteName",!1),e.send(null),z=200==e.status?JSON.parse(e.responseText).data:"XXXX管理系统"},BASE64HEADER:"data:image/png;base64,",downloadFn:(e=null)=>{if(!e)return;const t=new Blob([e]),s=window.URL.createObjectURL(t),a=document.createElement("a");a.style.display="none",a.download=(new Date).getTime()+".csv",a.href=s,a.click()}};var W=s(72631),G=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"login"}},[t("el-form",{staticClass:"login-box wow bounceIn",style:"GO"!=e.loginStatus?"backdrop-filter: blur(20px);transition: backdrop-filter 10s":"backdrop-filter: blur(0px);transition: backdrop-filter 3s",attrs:{"label-width":"80px","data-wow-duration":"2s","data-wow-delay":"0s"},model:{value:e.loginForm,callback:function(t){e.loginForm=t},expression:"loginForm"}},[t("el-row",[t("h3",{staticClass:"login-title"},[e._v("欢迎登录"+e._s(e.userInfo.userName?`,${e.userInfo.userName}`:""))])]),t("el-row",{directives:[{name:"show",rawName:"v-show",value:null!=e.userInfo&&null!=e.userInfo.userAvatar,expression:"userInfo!=null&&userInfo.userAvatar!=null"}]},[t("center",[t("el-avatar",{key:e.userInfo.userAvatar,attrs:{src:e.userInfo.userAvatar,size:100}})],1),t("br")],1),t("el-row",[t("el-col",{attrs:{xs:e.spanView.xs,sm:e.spanView.sm,md:e.spanView.md,lg:e.spanView.lg,xl:e.spanView.xl}},[t("el-form-item",{attrs:{prop:"userAccount"}},[t("span",{staticClass:"login-label",attrs:{slot:"label"},slot:"label"},[e._v(" 账号 ")]),t("el-input",{attrs:{type:"text",placeholder:"请输入账号"},on:{change:e.getLoginUserInfo},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit.apply(null,arguments)}},model:{value:e.loginForm.userAccount,callback:function(t){e.$set(e.loginForm,"userAccount",t)},expression:"loginForm.userAccount"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{xs:e.spanView.xs,sm:e.spanView.sm,md:e.spanView.md,lg:e.spanView.lg,xl:e.spanView.xl}},[t("el-form-item",{attrs:{prop:"passWord"}},[t("span",{staticClass:"login-label",attrs:{slot:"label"},slot:"label"},[e._v(" 密码 ")]),t("el-input",{attrs:{type:"password",placeholder:"请输入密码","show-password":!0},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit.apply(null,arguments)}},model:{value:e.loginForm.passWord,callback:function(t){e.$set(e.loginForm,"passWord",t)},expression:"loginForm.passWord"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{xs:e.spanView.xs,sm:e.spanView.sm,md:e.spanView.md,lg:e.spanView.lg,xl:e.spanView.xl}},[t("el-form-item",[t("el-button",{attrs:{type:"info",icon:"GO"==e.loginStatus?"el-icon-d-arrow-right":"el-icon-loading",rounds:"",disabled:"GO"!=e.loginStatus},on:{click:e.onSubmit}},[e._v(e._s(e.loginStatus))])],1)],1)],1),t("globel-footer")],1)],1)},j=[],q=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"text-align":"center"}},[e._v(" @"+e._s(e.Time)+" "),t("br"),e._v("PoweredBy "),t("br"),e._v(e._s(e.SiteName)+" ")])},X=[],H={name:"globelFooter",data(){return{Time:null,SiteName:null}},mounted(){var e=(new Date).getFullYear();this.axios.get(Z.getAttributeByCommon+"publishTime").then((t=>{t.data.code||t.data.data!=e?this.Time=e.toString():this.Time=t.data.data})).catch((()=>{this.Time=e.toString()})),this.axios.get(Z.getAttributeByCommon+"siteName").then((e=>{e.data.code?this.SiteName=V.protectTitle():this.SiteName=e.data.data})).catch((()=>{this.SiteName=V.protectTitle()}))}},Q=H,J=(0,i.Z)(Q,q,X,!1,null,"0a97e6b0",null),K=J.exports,Y={userAccount:null,passWord:null,checkCode:null,dateStamp:null};const ee="/tool/checkcode",te={imgcheckcodeTouch:`${ee}/touchImg/`,checkCodeSend:`${ee}/send`};var se={name:"loginPage",components:{GlobelFooter:K},data(){return{spanView:{xs:{span:12,offset:6},sm:{span:12,offset:6},md:{span:12,offset:6},lg:{span:6,offset:9},xl:{span:6,offset:9}},loginStatus:"GO",userInfo:{},loginForm:Y,useCheckCode:!1,checkCodeUrl:null}},methods:{...w.nv["setToken"],getLoginUserInfo(){x.getUserVOByUserAccount(Y.userAccount).then((e=>{e.data&&!e.data.code&&e.data.data?this.userInfo=e.data.data:this.userInfo={}})).catch((()=>{this.userInfo={}}))},getCheckCode(){Y.dateStamp=(new Date).getTime(),this.checkCodeUrl=`${k}${te.imgcheckcodeTouch}`+Y.dateStamp},onSubmit(){this.loginStatus="waiting...";var e={},t=T.AesEncrypt(Y.passWord,this.$store.state.user.hexMsg);e.passWord=t,e.userName=Y.userAccount,this.axios.post(x.sysLogin,e).then((e=>{e.data.code?40401==e.data.code||50001==e.data.code?(this.useCheckCode=!0,this.loginStatus="GO",this.$message.warning(e.data.message),this.getCheckCode()):(this.loginStatus="GO",this.$message.warning(e.data.message)):(sessionStorage.setItem("loginStatus",JSON.stringify(e.data.data)),this.$store.state.user.token=e.headers.get("Token"),this.$message.success("登录成功"),this.$route.query.redirect&&this.$router.push({path:this.$route.query.redirect}))})).catch((()=>{this.loginStatus="GO"}))},reg(){this.axios.get().then((e=>{e.data.code||this.$message.success(e.data.message)}))}},mounted(){(new this.$wow.WOW).init(),this.$store.dispatch("getUUIDputState"),this.loginForm.userAccount&&this.getLoginUserInfo(this.loginForm.userAccount)}},ae=se,re=(0,i.Z)(ae,G,j,!1,null,"11a87f24",null),oe=re.exports,ne=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"manggerCenter"}},[t("el-container",[t("el-aside",{staticClass:"wow bounceInLeft",attrs:{width:e.isCollapse,"data-wow-duration":"0.1s","data-wow-delay":"0s"}},[t("mangger-lefter",{attrs:{isCollapse:e.collapse}})],1),t("el-container",[t("el-header",{staticClass:"wow bounceInDown",attrs:{"data-wow-duration":"1s","data-wow-delay":"0s"}},[t("el-col",{staticClass:"wow bounceInUp",attrs:{span:23,"data-wow-duration":"1s","data-wow-delay":"0s"}},[t("el-menu",{staticClass:"wow bounceInUp",attrs:{mode:"horizontal","data-wow-duration":"1s","data-wow-delay":"0s"}},[t("el-menu-item",{nativeOn:{click:function(t){return e.Collapse.apply(null,arguments)}}},[t("i",{class:e.collapse?"el-icon-s-unfold":"el-icon-s-fold"})]),t("el-menu-item",{nativeOn:{click:function(t){return e.leftPage.apply(null,arguments)}}},[t("i",{staticClass:"el-icon-back"})]),t("el-menu-item",{nativeOn:{click:function(t){return e.rightPage.apply(null,arguments)}}},[t("i",{staticClass:"el-icon-right"})])],1)],1),t("el-col",{attrs:{span:1}},[t("el-dropdown",{attrs:{index:"1",placement:"bottom-start",divided:!0},on:{"visible-change":function(t){e.avatarOpen^=1}}},[t("el-button",{attrs:{type:"text",size:"medium"}},[t("el-avatar",{attrs:{src:this.currentUser.userAvatar}}),t("i",{key:e.avatarOpen,class:e.avatarOpen?"el-icon-arrow-down":"el-icon-arrow-up"})],1),t("el-dropdown-menu",[t("el-dropdown-item",{attrs:{index:"1-1"}},[e._v(e._s(e.currentUser.userName)+"("+e._s(e.currentUser.userAccount)+")")]),t("el-dropdown-item",{attrs:{index:"1-2"},nativeOn:{click:function(t){return e.layOut.apply(null,arguments)}}},[e._v("退出登录")])],1)],1)],1)],1),t("el-main",{staticStyle:{"background-color":"#f6f6f6"}},[t("manngger-main",{staticClass:"wow bounceInUp",attrs:{"data-wow-duration":"1s","data-wow-delay":"0s"}})],1)],1)],1)],1)},le=[],ie=function(){var e=this,t=e._self._c;return t("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":0!=this.$route.path.lastIndexOf("/")?this.$route.path.substring(0,this.$route.path.indexOf("/",1)):this.$route.path,"unique-opened":!0,collapse:e.isCollapse,router:""}},[t("el-header",{staticStyle:{padding:"0px 0px"},attrs:{height:"250px"}},[0==e.isCollapse?t("el-avatar",{key:e.isCollapse,staticStyle:{"margin-top":"50px","background-color":"rgba(255,255,255,0)"},attrs:{id:"logo",shape:"squre",size:160,src:e.logo}}):e._e()],1),t("el-menu-item",{attrs:{index:"/dataPage"}},[t("i",{staticClass:"el-icon-star-off"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("首页")])]),t("el-submenu",{attrs:{index:"/user"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-coin"}),t("span",[e._v("用户系统")])]),"admin"==e.user.userRole?t("el-menu-item",{attrs:{index:"/userPage"}},[t("i",{staticClass:"el-icon-user"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("用户管理")])]):e._e(),"admin"==e.user.userRole?t("el-menu-item",{attrs:{index:"/tokenPage"}},[t("i",{staticClass:"el-icon-user"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("Token管理")])]):e._e(),"admin"==e.user.userRole?t("el-menu-item",{attrs:{index:"/rolePage"}},[t("i",{staticClass:"el-icon-user"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("角色管理")])]):e._e()],2),"admin"==e.user.userRole||"dev"==e.user.userRole?t("el-submenu",{attrs:{index:"setting"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-setting"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("系统配置")])]),"admin"==e.user.userRole?t("el-menu-item",{attrs:{index:"/settingPage"}},[t("i",{staticClass:"el-icon-set-up"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("站点设置")])]):e._e(),"admin"==e.user.userRole||"dev"==e.user.userRole?t("el-menu-item",{attrs:{index:"/loginfo"}},[t("i",{staticClass:"el-icon-notebook-1"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("日志查看")])]):e._e(),"admin"==e.user.userRole||"dev"==e.user.userRole?t("el-menu-item",{attrs:{index:"/authPage"}},[t("i",{staticClass:"el-icon-set-up"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("接口鉴权管理")])]):e._e()],2):e._e(),t("el-menu-item",{nativeOn:{click:function(t){return e.logout()}}},[t("i",{staticClass:"el-icon-switch-button"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("用户退出")])]),t("div",[0==e.isCollapse?t("globel-footer",{key:e.isCollapse}):e._e()],1)],1)},ue=[];const ce="",de={getInfo:`${ce}/get/usinfo`,reload:`${ce}/reload`,list:`${ce}/list`,open:`${ce}/open`,close:`${ce}/close`,del:e=>Ps.delete(`${ce}/`,{data:e}),page:e=>Ps.get(`${ce}/page`,{params:e}),add:e=>Ps.post(`${ce}/`,e)};var me={name:"manggerLefter",components:{GlobelFooter:K},props:{isCollapse:null},data(){return{logo:null,user:JSON.parse(sessionStorage.getItem("loginStatus"))}},computed:{},methods:{logout(){this.axios.post(x.sysLogout).then((e=>{this.$store.dispatch("setToken"),sessionStorage.removeItem("loginStatus"),e.data.code?this.$message.error(e.data.message):this.$message.success(e.data.message),this.$router.go(0)}))},routeReload(){this.axios.get(de.reload).then((e=>{var t=e.data;t.code?this.$message.error(t.message):this.$message.success(t.message)})).catch((e=>{this.$message.info(e.data.message)}))}},mounted(){this.axios.get(Z.getAttributeByCommon+"siteLogo").then((e=>{e.data.code||(this.logo=e.data.data)}))}},he=me,pe=(0,i.Z)(he,ie,ue,!1,null,"2d0ceab6",null),ge=pe.exports,fe=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mannggerMain"},[t("el-container",[t("el-header",[t("el-card",[t("el-breadcrumb",{key:(new Date).getTime(),attrs:{separator:"/"}},e._l(e.breadcrumb,(function(s,a){return t("el-breadcrumb-item",{key:a,attrs:{to:{path:s.path}}},[e._v(" "+e._s(s.meta.title)+" ")])})),1)],1)],1),t("el-main",[t("el-card",[t("router-view")],1)],1)],1)],1)},ve=[],be=(s(30541),{name:"mannggerMain",data(){return{routerName:null,routerDir:null}},computed:{breadcrumb(){let e=this.$route.matched.filter((e=>e.meta.showInbreadcrumb));return"首页"!==e[0].meta.title&&e.unshift({path:"/",meta:{showInbreadcrumb:!0,title:"首页"}}),e}},methods:{},mounted(){}}),ye=be,ke=(0,i.Z)(ye,fe,ve,!1,null,"100d3748",null),we=ke.exports,_e={name:"manggerCenter",components:{MannggerMain:we,ManggerLefter:ge},data(){return{collapse:0,currentUser:{},avatarOpen:0}},created(){this.currentUser=JSON.parse(sessionStorage.getItem("loginStatus"))},mounted(){(new this.$wow.WOW).init(),this.axios.get(Z.getAttributeByCommon+"siteLogo").then((e=>{e.data.code||(this.currentUser.userAvatar=e.data.data)}))},methods:{leftPage(){this.$router.go(-1)},rightPage(){this.$router.go(1)},Collapse(){this.collapse^=1},layOut(){this.$store.dispatch("setToken"),sessionStorage.removeItem("loginStatus"),this.$router.go(0)}},computed:{isCollapse(e){return e}}},xe=_e,Ce=(0,i.Z)(xe,ne,le,!1,null,"59f85d75",null),Se=Ce.exports,$e=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"chart-box"},[t("el-row",{attrs:{gutter:45}},[t("el-col",{attrs:{span:6,offset:3}},[t("el-card",{staticClass:"charBox"},[t("div",{staticClass:"count1"},[t("span",[e._v(e._s(e.CountOne))])]),t("div",{staticClass:"a"},[e._v("用户数量")])])],1),t("el-col",{attrs:{span:6}},[t("el-card",{staticClass:"charBox"},[t("div",{staticClass:"count2"},[t("span",[e._v(e._s(e.CountTwo))])]),t("div",{staticClass:"b"},[e._v(" 接管API数量 ")])])],1),t("el-col",{attrs:{span:6}},[t("el-card",{staticClass:"charBox"},[t("div",{staticClass:"count3"},[t("span",{key:(new Date).getTime()},[e._v(e._s(e.getRunnedTime))])]),t("div",{staticClass:"b"},[e._v(" 运行天数 ")])])],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-card",{attrs:{id:"apiIncrease"}})],1),t("el-col",{attrs:{span:12}},[t("el-card",{attrs:{id:"userIncrease"}})],1)],1)],1)])},Te=[],Oe=s(9043);const Ae="/count",Ie={userCount:`${Ae}/user`,docCount:`${Ae}/auth`,userIncCount:`${Ae}/userinc`,increaseCount:`${Ae}/authinc`,runTime:`${Ae}/running`};var Fe={name:"dataPage",data(){return{CountOne:"",CountTwo:"",countRunning:null,authColumns:[],authValues:[],userColumns:[],userValues:[]}},mounted(){this.getincreaseCount(),this.getGraphIncDataWithUser(),this.getUserCount(),this.getHomeCount(),this.getRunningTime()},computed:{getRunnedTime(){var e=new Date(this.countRunning),t=new Date,s=(t-e)/1e3,a=parseInt(s/86400),r=parseInt(s/3600)-24*a,o=parseInt(s%3600/60),n=parseInt(s%60);return a+"天"+r+"小时"+o+"分钟"+n+"秒"}},methods:{getUserCount(){this.axios.get(Ie.userCount).then((e=>{e.data.code||(this.CountOne=e.data.data)}))},getRunningTime(){this.axios.get(Ie.runTime).then((e=>{e.data.code||(this.countRunning=e.data.data)}))},getHomeCount(){this.axios.get(Ie.docCount).then((e=>{e.data.code||(this.CountTwo=e.data.data)}))},getincreaseCount(){this.axios.get(Ie.increaseCount,{params:{month:7}}).then((e=>{e.data.code||(this.authColumns=e.data.data.columns,this.authValues=e.data.data.values,null!=this.authColumns&&null!=this.authValues&&this.authColumns.length>0&&this.authValues.length>0&&this.setApiGraph())}))},getGraphIncDataWithUser(){this.axios.get(Ie.userIncCount,{params:{month:7}}).then((e=>{e.data.code||(this.userColumns=e.data.data.columns,this.userValues=e.data.data.values,null!=this.userColumns&&null!=this.userValues&&this.userValues.length>0&&this.userValues.length>0&&this.setUserGraph())}))},setApiGraph(){const e=Oe.S1(document.getElementById("apiIncrease")),t={title:{text:"API接口日增量",left:"center",top:"5px"},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["bar"]},restore:{show:!0},saveAsImage:{show:!0}}},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},xAxis:{name:"时间",type:"category",data:this.authColumns},yAxis:{name:"增加数量",type:"value"},series:[{name:"增加数量",data:this.authValues,type:"line"}]};e.setOption(t)},setUserGraph(){const e=Oe.S1(document.getElementById("userIncrease")),t={title:{text:"用户日增量",left:"center",top:"5px"},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["bar"]},restore:{show:!0},saveAsImage:{show:!0}}},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},xAxis:{name:"时间",type:"category",data:this.userColumns},yAxis:{name:"增加数量",type:"value"},series:[{name:"增加数量",data:this.userValues,type:"line"}]};e.setOption(t)}}},Re=Fe,Pe=(0,i.Z)(Re,$e,Te,!1,null,"0ef13e6f",null),Ee=Pe.exports,Ue=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"siteSettingPage"}},[t("el-row",{staticStyle:{"margin-bottom":"25px"}},[t("b",[t("el-col",{staticStyle:{"margin-left":"40px"},attrs:{span:"3"}},[e._v("属性名")]),t("el-col",{attrs:{span:"9"}},[e._v("属性值")]),t("el-col",{attrs:{span:"2"}},[e._v("注释")])],1)]),t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[t("el-checkbox-group",{model:{value:e.checklist,callback:function(t){e.checklist=t},expression:"checklist"}},[e._l(e.form.commonList,(function(s){return t("el-row",{key:s.attribute,staticStyle:{"margin-bottom":"10px"}},[t("el-col",{attrs:{span:"3"}},[t("el-checkbox",{staticStyle:{float:"left"},attrs:{size:"medium",label:s.attribute}},[e._v(" "+e._s(s.attribute)+" ")])],1),t("el-col",{attrs:{span:"9"}},[1==s.type?t("input",{staticStyle:{display:"inline"},attrs:{type:"file",name:"file"},on:{change:function(t){return e.submit(t,s)}}}):e._e(),2==s.type?t("el-input",{attrs:{"show-password":""},model:{value:s.value,callback:function(t){e.$set(s,"value",t)},expression:"item.value"}}):t("el-input",{model:{value:s.value,callback:function(t){e.$set(s,"value",t)},expression:"item.value"}})],1),t("el-col",{attrs:{span:"10"}},[t("el-link",{staticStyle:{"margin-left":"3px",color:"#989aa2"},attrs:{unline:!1}},[e._v(e._s(s.comment))])],1)],1)})),t("el-col",{attrs:{span:"1"}},[t("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")])],1)],2),t("br"),t("el-form-item",[t("el-button",{attrs:{type:"primary",disabled:e.disabled},on:{click:e.save}},[e._v("保存")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addbox=!0}}},[e._v("新增一项")]),t("el-button",{attrs:{type:"danger"},on:{click:e.dodel}},[e._v("删除")])],1)],1),t("el-dialog",{attrs:{title:"新增配置",visible:e.addbox,width:"30%",center:""},on:{"update:visible":function(t){e.addbox=t}}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-form",{model:{value:e.newCommon,callback:function(t){e.newCommon=t},expression:"newCommon"}},[t("el-form-item",{attrs:{label:"属性名"}},[t("el-input",{model:{value:e.newCommon.attribute,callback:function(t){e.$set(e.newCommon,"attribute",t)},expression:"newCommon.attribute"}})],1),t("el-form-item",{attrs:{label:"属性值"}},[t("el-input",{model:{value:e.newCommon.value,callback:function(t){e.$set(e.newCommon,"value",t)},expression:"newCommon.value"}})],1),t("el-form-item",{attrs:{label:"属性备注"}},[t("el-input",{model:{value:e.newCommon.comment,callback:function(t){e.$set(e.newCommon,"comment",t)},expression:"newCommon.comment"}})],1),t("el-form-item",{attrs:{label:"属性类型"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.newCommon.type,callback:function(t){e.$set(e.newCommon,"type",t)},expression:"newCommon.type"}},[t("el-option",{attrs:{label:"文本型",value:0}}),t("el-option",{attrs:{label:"文件型",value:1}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addbox=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("确 定")])],1)],1)],1)},Be=[];const Ne="/tool/oss",De={upload:Ne+"/upload",uploadAdmin:Ne+"/root/upload/"};var Le=s(47327);class Me{constructor(){(0,Le.Z)(this,"id",void 0),(0,Le.Z)(this,"ids",[])}}var Ze={name:"siteSettingPage",data(){return{checkAll:!1,isIndeterminate:!1,checklist:[],form:{commonList:[]},disabled:!1,newCommon:{attribute:null,value:null,comment:null,type:null},addbox:!1}},methods:{dodel(){for(var e=0;e<this.checklist.length;e++)for(var t=0;t<this.form.commonList.length;t++)this.checklist[e]==this.form.commonList[t].attribute&&this.form.commonList.splice(t,1)},handleCheckAllChange(e){if(e){this.checklist=[];for(var t=0;t<this.form.commonList.length;t++)this.checklist.push(this.form.commonList[t].attribute);this.checkAll=this.isIndeterminate=!0}else this.checklist=[],this.checkAll=this.isIndeterminate=!1},submit(e,t){var s=e.target.files[0];s.size>335544320&&this.$message.error("文件上传最多为320MB");var a=new FormData,r=s.name.toString();r=r.substring(r.lastIndexOf(".")),a.append("file",s,"sitePage"+t.attribute+r),this.$message.info(t.attribute+"正在上传，请稍后"),this.axios.put(De.uploadAdmin,a).then((e=>{e.data.code||(t.value=e.data.data,this.$message.success(t.attribute+"上传成功！"))}))},add(){this.form.commonList.push({attribute:this.newCommon.attribute,value:this.newCommon.value,comment:this.newCommon.comment,type:this.newCommon.type}),this.addbox=!1},save(){this.axios.post(Z.saveCommon,this.form).then((e=>{e.data.code?this.$message({message:"错误码:"+e.data.code+"\n服务器错误！\n错误信息："+e.data.message,dangerouslyUseHTMLString:!0,type:"error"}):this.$message.success(e.data.message)}));var e=new Me;e.id=this.checklist}},mounted(){this.axios.get(Z.getCommonList).then((e=>{e.data.code?this.$message.error("错误码:"+e.data.code+"\n服务器错误！\n错误信息："+e.data.message):this.form.commonList=e.data.data}))}},ze=Ze,Ve=(0,i.Z)(ze,Ue,Be,!1,null,"bc74a7f8",null),We=Ve.exports,Ge=function(){var e=this,t=e._self._c;return t("div",[t("el-radio",{attrs:{label:0},model:{value:e.open,callback:function(t){e.open=t},expression:"open"}},[e._v("彩色版")]),t("el-radio",{attrs:{label:1},model:{value:e.open,callback:function(t){e.open=t},expression:"open"}},[e._v("简洁版")]),t("div",{key:(new Date).getTime()},[e.open?t("iframe",{attrs:{src:"static/doc/Apidocmarkdown.html"}}):t("iframe",{attrs:{src:"static/doc/Apidocstyle.html"}})])],1)},je=[],qe={name:"apiDoc",data(){return{open:0}}},Xe=qe,He=(0,i.Z)(Xe,Ge,je,!1,null,"ded0c9aa",null),Qe=He.exports,Je=function(){var e=this,t=e._self._c;return t("el-container",[t("el-header",[t("el-row",[t("el-col",{attrs:{span:1.5}},[t("el-button",{attrs:{icon:"el-icon-circle-plus-outline",type:"primary"},on:{click:function(t){e.addUser=!0,e.select=null}}},[e._v("新增用户")]),e._v("  ")],1),t("el-col",{attrs:{span:1.5}},[t("el-button",{attrs:{type:"danger",icon:"el-icon-plus"},on:{click:e.deleteByList}},[e._v("批量删除")]),e._v("  ")],1),t("el-col",{attrs:{span:1.5}},[t("el-button",{attrs:{type:"info",icon:"el-icon-download"},on:{click:e.downloadCSV}},[e._v("导出CSV")]),e._v("  ")],1),t("el-col",{attrs:{span:3}},[t("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{accept:".csv","on-change":e.uploadFile,"auto-upload":!1,"before-upload":e.beforeUpload,"file-list":e.fileList}},[t("el-button",{attrs:{size:"large",type:"primary",icon:"el-icon-upload2"}},[e._v("导入CSV")])],1)],1),t("el-col",{attrs:{span:"12"}},[t("el-col",{staticStyle:{"margin-right":"3px"},attrs:{span:"12"}},[t("el-input",{attrs:{placeholder:"搜搜看"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}},[t("i",{staticClass:"el-icon-search",attrs:{slot:"suffix"},on:{click:e.search},slot:"suffix"})])],1)],1)],1)],1),t("el-main",[t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",lazy:"",data:e.userDatas},on:{"selection-change":e.addCheck}},[t("el-table-column",{attrs:{type:"selection",width:"39"}}),t("el-table-column",{attrs:{property:"id",label:"id",sortable:"",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.id)+" ")]}}])}),t("el-table-column",{attrs:{property:"userName",label:"用户昵称",width:"250"}}),t("el-table-column",{attrs:{property:"userRole",label:"角色",width:"250"},scopedSlots:e._u([{key:"default",fn:function(s){return["admin"==s.row.userRole?t("el-tag",{attrs:{type:"danger"}},[e._v(e._s(e.roles[s.row.userRole]))]):"auditor"==s.row.userRole?t("el-tag",{attrs:{type:"warning"}},[e._v(e._s(e.roles[s.row.userRole]))]):"expert"==s.row.userRole?t("el-tag",{attrs:{type:"success"}},[e._v(e._s(e.roles[s.row.userRole]))]):"user"==s.row.userRole?t("el-tag",[e._v(e._s(e.roles[s.row.userRole]))]):t("el-tag",{attrs:{type:"info"}},[e._v(e._s(e.roles[s.row.userRole]))])]}}])}),t("el-table-column",{attrs:{property:"createdTime",label:"注册日期",sortable:"",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(new Date(t.row.createdTime).toLocaleString())+" ")]}}])}),t("el-table-column",{attrs:{property:"updateTime",label:"最近修改日期",sortable:"",width:"199"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(new Date(t.row.updateTime).toLocaleString())+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.edit=!0,e.select=s.row}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(s.row)}}},[e._v("删除")])]}}])})],1)],1),t("el-footer",[t("el-pagination",{attrs:{"current-page":e.userQureyPageBody.current,"page-size":e.userQureyPageBody.pageSize,"page-sizes":[5,10,15,20,25],layout:"total, sizes, prev, pager, next, jumper",total:this.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.userQureyPageBody,"current",t)},"update:current-page":function(t){return e.$set(e.userQureyPageBody,"current",t)},"update:pageSize":function(t){return e.$set(e.userQureyPageBody,"pageSize",t)},"update:page-size":function(t){return e.$set(e.userQureyPageBody,"pageSize",t)}}})],1),t("el-dialog",{attrs:{visible:e.edit,title:"编辑用户"},on:{"update:visible":function(t){e.edit=t}}},[t("user-message-box",{key:(new Date).getTime()})],1),t("el-dialog",{attrs:{visible:e.addUser,title:"新增用户"},on:{"update:visible":function(t){e.addUser=t}}},[t("user-message-box")],1)],1)},Ke=[],Ye=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{attrs:{model:e.reqBody,"label-position":"left"}},[t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"用户昵称",property:"userName"}},[t("el-input",{model:{value:e.userBody.userName,callback:function(t){e.$set(e.userBody,"userName",t)},expression:"userBody.userName"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"用户密码",property:"passWord"}},[t("el-input",{model:{value:e.userBody.passWord,callback:function(t){e.$set(e.userBody,"passWord",t)},expression:"userBody.passWord"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"用户角色",property:"userRole"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.userBody.userRole,callback:function(t){e.$set(e.userBody,"userRole",t)},expression:"userBody.userRole"}},e._l(this.$store.state.user.roles,(function(e,s){return t("el-option",{key:e,attrs:{label:e,value:s}})})),1)],1)],1)],1)],1),this.update?t("el-button",{attrs:{type:"primary"},on:{click:e.updateUser}},[e._v("保存")]):t("el-button",{attrs:{type:"success"},on:{click:e.addUser}},[e._v("提交")]),t("el-button",{attrs:{stype:"danger"},on:{click:e.cancel}},[e._v("取消")])],1)},et=[];class tt{constructor(){(0,Le.Z)(this,"userName",void 0),(0,Le.Z)(this,"userAccount",void 0),(0,Le.Z)(this,"userRole",void 0),(0,Le.Z)(this,"passWord",void 0)}}var st={clone(e){return JSON.parse(JSON.stringify(e))}},at={name:"userMessageBox",data(){return{update:null!=this.$parent.$parent.$parent.select,userBody:this.$parent.$parent.$parent.select||new tt,reqBody:null}},methods:{async updateUser(){null==this.userBody.passWord&&delete this.userBody.passWord,this.reqBody=st.clone(this.userBody),this.reqBody.userGender=this.userBody.userGender,null!=this.userBody.passWord&&(this.reqBody.passWord=T.AesEncrypt(this.userBody.passWord,this.$store.state.user.uuid)),await this.axios.post(x.userUpdateAdmin,this.reqBody).then((e=>{e.data.code||this.$message.success(e.data.message)}))},cancel(){this.update?(this.$parent.$parent.$parent.select=null,this.$parent.$parent.$parent.edit=!1):this.$parent.$parent.$parent.addUser=!1},async addUser(){null==this.userBody.passWord&&delete this.userBody.passWord,this.reqBody=st.clone(this.userBody),null!=this.userBody.passWord&&(this.reqBody.passWord=T.AesEncrypt(this.userBody.passWord,this.$store.state.user.uuid)),await this.axios.post(x.userAdd,this.reqBody).then((e=>{e.data.code||(this.reqBody.id=e.data.data,this.$parent.$parent.$parent.userDatas.push(this.reqBody),this.$message.success(e.data.message))}))}},mounted(){this.$store.dispatch("getUUIDputState"),this.userBody.passWord=null}},rt=at,ot=(0,i.Z)(rt,Ye,et,!1,null,"195070da",null),nt=ot.exports;class lt{constructor(){(0,Le.Z)(this,"current",1),(0,Le.Z)(this,"pageSize",10),(0,Le.Z)(this,"sortField","createdTime"),(0,Le.Z)(this,"sortOrder",null)}}class it extends lt{constructor(...e){super(...e),(0,Le.Z)(this,"id",null),(0,Le.Z)(this,"userName",null),(0,Le.Z)(this,"userAccount",null),(0,Le.Z)(this,"userRole",null),(0,Le.Z)(this,"userGender",0)}}var ut=s(51450),ct={name:"userPage",computed:{row(){return ut.Z}},components:{UserMessageBox:nt},data(){return{select:null,edit:!1,user:sessionStorage.getItem("loginStatus"),total:0,userDatas:[],searchText:null,addUser:!1,userQureyPageBody:new it,reqBody:{userVoList:[]},ids:[],fileList:[],roles:this.$store.state.user.roles,genders:this.$store.state.user.genders}},methods:{toggleSelection(e){e?e.forEach((e=>{this.$refs.multipleTable.toggleRowSelection(e)})):this.$refs.multipleTable.clearSelection()},gotoGarbage(){this.$router.push("/userGarbagePage")},delete(e){var t=new Me;t.id=e.id,this.axios.post(x.deleteUser,t).then((t=>{t.data.code||(this.$message.success(t.data.message),this.userDatas.splice(this.userDatas.indexOf(e),1))}))},handleDelete(e){"admin"==e.userRole?this.$confirm("用户 Id="+e.id+" "+e.userAccount+"("+e.userName+") 为管理员账户, 是否继续删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.delete(e)})).catch((()=>{})):this.delete(e)},deleteByList(){for(var e=0;e<this.reqBody.userVoList.length;e++)this.handleDelete(this.reqBody.userVoList[e])},handleSelectionChange(e){this.ids=[],e.forEach((e=>{this.ids.push(e.id)}))},beforeUpload(e){const t=e.name.substring(e.name.lastIndexOf(".")+1),s=["csv"];if(-1===s.indexOf(t))return this.$message.error("上传文件只能是csv格式"),!1},async uploadFile(e){const t=new FormData;t.append("file",e.raw),await x.importUser(t).then((e=>{if(console.log(e),0!==e.data.code)return this.$message.error("导入失败");this.$message.success("导入成功"),this.$refs.upload.clearFiles()}))},downloadCSV(){0==this.ids.length?this.$message.warning("请勾选要导出的数据项，在id项前面打勾"):x.exportUser({ids:this.ids}).then((e=>{200==e.status?(V.downloadFn(e.data),this.$message.success("导出成功")):this.$message.error("导出CSV发生错误")}))},addCheck(e){this.ids=e.map((e=>e.id)),this.reqBody.userVoList=e},handleCurrentChange(e){this.userQureyPageBody.current=e,this.send()},handleSizeChange(e){this.userQureyPageBody.pageSize=e,this.send()},search(){this.userQureyPageBody.userAccount=this.searchText,this.userQureyPageBody.userName=this.searchText,this.send()},send(){this.axios.post(x.getUserslistPage,this.userQureyPageBody).then((e=>{e.data.code||(this.total=parseInt(e.data.data.total),this.userDatas=e.data.data.records)}))}},mounted(){this.userQureyPageBody.sortField="createdTime",this.send()}},dt=ct,mt=(0,i.Z)(dt,Je,Ke,!1,null,"0c083ec0",null),ht=mt.exports,pt=function(){var e=this,t=e._self._c;return t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-class-name":e.tableRowClassName}},[t("el-table-column",{attrs:{prop:"date",label:"日期",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(new Date(t.row.date).toLocaleString())+" ")]}}])}),t("el-table-column",{attrs:{prop:"message",label:"内容",width:"600"}}),t("el-table-column",{attrs:{prop:"type",label:"类型"}}),t("el-table-column",{attrs:{prop:"label",label:"级别"}}),t("el-table-column",{attrs:{prop:"data",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){e.open=!0,e.select=s.row.data}}},[e._v("查看详情")])]}}])})],1),t("el-dialog",{key:(new Date).getTime(),attrs:{title:"报错详情",visible:e.open,top:"2vh",width:"70%"},on:{"update:visible":function(t){e.open=t}}},[t("pre",{directives:[{name:"highlight-a",rawName:"v-highlight-a"}]},[e._v("\r\n      "),t("code",{staticClass:"java"},[e._v("\r\n        "+e._s(this.select)+"\r\n      ")]),e._v("\r\n    ")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"danger"},on:{click:function(t){e.open=!1}}},[e._v("关闭")])],1)])],1)},gt=[];const ft="/log",vt={info:`${ft}/info`};var bt={name:"logPage",data(){return{tableData:null,select:null,open:!1}},mounted(){this.axios.get(vt.info).then((e=>{e.data.code||(this.tableData=e.data.data,this.$message.success(e.data.message))})).catch((()=>{this.$message.error("消息队列堆积，请清理后再试...")}))}},yt=bt,kt=(0,i.Z)(yt,pt,gt,!1,null,"14c6b004",null),wt=kt.exports,_t=function(){var e=this,t=e._self._c;return t("div",[t("auth-search",{directives:[{name:"show",rawName:"v-show",value:e.isSearch,expression:"isSearch"}]}),t("el-row",[t("el-col",{attrs:{span:3}},[t("el-button",{on:{click:e.search}},[e._v(e._s((e.isSearch?"关闭":"打开")+"高级搜索"))])],1),t("el-col",{attrs:{span:3}},[t("el-button",{on:{click:e.reload}},[e._v("刷新鉴权")])],1),t("el-col",{attrs:{span:3}},[t("el-button",{on:{click:e.insert}},[e._v("新增鉴权")])],1)],1),t("auth-add",{directives:[{name:"show",rawName:"v-show",value:e.isAdd,expression:"isAdd"}]}),t("el-table",{attrs:{data:e.datas}},[t("el-table-column",{attrs:{prop:"id",label:"ID",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(`${t.row.id.substring(0,8)}···`)+" ")]}}])}),t("el-table-column",{attrs:{prop:"serviceName",label:"服务名称"}}),t("el-table-column",{attrs:{prop:"method",label:"请求方式"}}),t("el-table-column",{attrs:{prop:"route",label:"路由"}}),t("el-table-column",{attrs:{prop:"uri",label:"URI",width:"200"}}),t("el-table-column",{attrs:{label:"任意角色"},scopedSlots:e._u([{key:"default",fn:function(s){return e._l(s.row.anyRole,(function(s){return t("el-tag",{key:s.id,attrs:{type:"success"}},[e._v(e._s(s))])}))}}])}),t("el-table-column",{attrs:{label:"必有角色"},scopedSlots:e._u([{key:"default",fn:function(s){return e._l(s.row.mustRole,(function(s){return t("el-tag",{key:s.id,attrs:{type:"danger"}},[e._v(e._s(s))])}))}}])}),t("el-table-column",{attrs:{label:"任意权限码",width:"100"},scopedSlots:e._u([{key:"default",fn:function(s){return e._l(s.row.anyPermission,(function(s){return t("el-tag",{key:s.id,attrs:{type:"success"}},[e._v(e._s(s))])}))}}])}),t("el-table-column",{attrs:{label:"必有权限码",width:"100"},scopedSlots:e._u([{key:"default",fn:function(s){return e._l(s.row.anyPermission,(function(s){return t("el-tag",{key:s.id,attrs:{type:"danger"}},[e._v(e._s(s))])}))}}])}),t("el-table-column",{attrs:{label:"角色校验逻辑",width:"110"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-tag",{attrs:{type:"warning"}},[e._v(e._s(s.row.roleMode))])]}}])}),t("el-table-column",{attrs:{label:"权限码校验逻辑",width:"120"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-tag",{attrs:{type:"warning"}},[e._v(e._s(s.row.permissionMode))])]}}])}),t("el-table-column",{attrs:{label:"逻辑容器走向",width:"120"},scopedSlots:e._u([{key:"default",fn:function(s){return e._l(s.row.logicIndex,(function(s){return t("el-tag",{key:s.id,attrs:{type:"danger"}},[e._v(e._s(s))])}))}}])}),t("el-table-column",{attrs:{prop:"operUser",label:"上一次操作UserAccount",width:"180"}}),t("el-table-column",{attrs:{label:"仅需要检查登录",width:"150"},scopedSlots:e._u([{key:"default",fn:function(s){return[1==s.row.onlyCheckLogin?t("el-tag",{attrs:{type:"success"}},[e._v("是")]):t("el-tag",{attrs:{type:"danger"}},[e._v("否")])]}}])}),t("el-table-column",{attrs:{label:"是否非注解鉴权",width:"120"},scopedSlots:e._u([{key:"default",fn:function(s){return[1==s.row.isDefault?t("el-tag",{attrs:{type:"success"}},[e._v("是")]):t("el-tag",{attrs:{type:"danger"}},[e._v("否")])]}}])}),t("el-table-column",{attrs:{label:"是否开启"},scopedSlots:e._u([{key:"default",fn:function(s){return[1==s.row.isOpen?t("el-tag",{attrs:{type:"success"}},[e._v("是")]):t("el-tag",{attrs:{type:"danger"}},[e._v("否")])]}}])}),t("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150"},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.isOpen?t("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){return e.closeAuth(s.row)}}},[e._v("关闭")]):t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.openAuth(s.row)}}},[e._v("开启")]),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.delAuth(s.row)}}},[e._v("删除")])]}}])})],1)],1)},xt=[],Ct=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"auth-search"},[t("el-header",[e._v(" 路由查询 ")]),t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm}},[t("el-form-item",{attrs:{label:"ID"}},[t("el-input",{attrs:{placeholder:"ID"},model:{value:e.searchForm.id,callback:function(t){e.$set(e.searchForm,"id",t)},expression:"searchForm.id"}})],1),t("el-form-item",{attrs:{label:"服务名称"}},[t("el-input",{attrs:{placeholder:"服务名称"},model:{value:e.searchForm.serviceName,callback:function(t){e.$set(e.searchForm,"serviceName",t)},expression:"searchForm.serviceName"}})],1),t("el-form-item",{attrs:{label:"请求方式"}},[t("el-select",{attrs:{placeholder:"请求方式"},model:{value:e.searchForm.method,callback:function(t){e.$set(e.searchForm,"method",t)},expression:"searchForm.method"}},[t("el-option",{attrs:{label:"GET",value:"GET"}}),t("el-option",{attrs:{label:"POST",value:"POST"}}),t("el-option",{attrs:{label:"PUT",value:"PUT"}}),t("el-option",{attrs:{label:"DELETE",value:"DELETE"}}),t("el-option",{attrs:{label:"PATCH",value:"PATCH"}}),t("el-option",{attrs:{label:"HEAD",value:"HEAD"}}),t("el-option",{attrs:{label:"OPTIONS",value:"OPTIONS"}}),t("el-option",{attrs:{label:"TRACE",value:"TRACE"}}),t("el-option",{attrs:{label:"CONNECT",value:"CONNECT"}})],1)],1),t("el-form-item",{attrs:{label:"URI"}},[t("el-input",{attrs:{placeholder:"URI"},model:{value:e.searchForm.uri,callback:function(t){e.$set(e.searchForm,"uri",t)},expression:"searchForm.uri"}})],1),t("el-form-item",{attrs:{label:"路由"}},[t("el-input",{attrs:{placeholder:"路由"},model:{value:e.searchForm.route,callback:function(t){e.$set(e.searchForm,"route",t)},expression:"searchForm.route"}})],1),t("el-input",{attrs:{placeholder:"角色"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addTag.apply(null,arguments)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.delTag.apply(null,arguments)}},model:{value:e.currentTag,callback:function(t){e.currentTag=t},expression:"currentTag"}}),e._l(e.searchForm.authRole,(function(s){return t("el-tag",{key:s,attrs:{closable:"","disable-transitions":!1},on:{close:function(t){return e.handleCloseTag(e.item)}}},[e._v(e._s(s))])})),t("el-form-item",{attrs:{label:"上一次操作UserAccount"}},[t("el-input",{attrs:{placeholder:"上一次操作UserAccount"},model:{value:e.searchForm.operUser,callback:function(t){e.$set(e.searchForm,"operUser",t)},expression:"searchForm.operUser"}})],1),t("el-form-item",{attrs:{label:"是否仅检查登录"}},[t("el-select",{attrs:{placeholder:"是否仅检查登录"},model:{value:e.searchForm.checkLogin,callback:function(t){e.$set(e.searchForm,"checkLogin",t)},expression:"searchForm.checkLogin"}},[t("el-option",{attrs:{label:"是",value:"true"}}),t("el-option",{attrs:{label:"否",value:"false"}})],1)],1),t("el-form-item",{attrs:{label:"是否非注解鉴权"}},[t("el-select",{attrs:{placeholder:"是否非注解鉴权"},model:{value:e.searchForm.isDef,callback:function(t){e.$set(e.searchForm,"isDef",t)},expression:"searchForm.isDef"}},[t("el-option",{attrs:{label:"是",value:"true"}}),t("el-option",{attrs:{label:"否",value:"false"}})],1)],1),t("el-form-item",{attrs:{label:"是否开启"}},[t("el-select",{attrs:{placeholder:"是否开启"},model:{value:e.searchForm.isOpen,callback:function(t){e.$set(e.searchForm,"isOpen",t)},expression:"searchForm.isOpen"}},[t("el-option",{attrs:{label:"是",value:"true"}}),t("el-option",{attrs:{label:"否",value:"false"}})],1)],1),t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")])],2)],1)},St=[],$t={name:"auth-search",data(){return{currentTag:null,searchForm:{uri:"",serviceName:"",method:"",route:"",authRole:"",operUser:"",checkLogin:"",isDef:"",isOpen:"",current:1,pageSize:10}}},methods:{handleCloseTag(e){this.searchForm.authRole.splice(this.searchForm.authRole.indexOf(e),1)},addTag(){this.searchForm.authRole.push(this.currentTag),this.currentTag=null},delTag(){null===this.currentTag&&this.searchForm.authRole.splice(this.searchForm.authRole.length-1,1)},search(){de.page(this.searchForm).then((e=>{e.data.code||(this.$parent.datas=e.data.data.records)}))}}},Tt=$t,Ot=(0,i.Z)(Tt,Ct,St,!1,null,"cf67bc76",null),At=Ot.exports,It=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"auth-add"},[t("el-header",[e._v(" 新增路由 ")]),t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm}},[t("el-form-item",{attrs:{label:"服务名称"}},[t("el-input",{attrs:{placeholder:"服务名称"},model:{value:e.searchForm.serviceName,callback:function(t){e.$set(e.searchForm,"serviceName",t)},expression:"searchForm.serviceName"}})],1),t("el-form-item",{attrs:{label:"请求方式"}},[t("el-select",{attrs:{placeholder:"请求方式"},model:{value:e.searchForm.method,callback:function(t){e.$set(e.searchForm,"method",t)},expression:"searchForm.method"}},[t("el-option",{attrs:{label:"GET",value:"GET"}}),t("el-option",{attrs:{label:"POST",value:"POST"}}),t("el-option",{attrs:{label:"PUT",value:"PUT"}}),t("el-option",{attrs:{label:"DELETE",value:"DELETE"}}),t("el-option",{attrs:{label:"PATCH",value:"PATCH"}}),t("el-option",{attrs:{label:"HEAD",value:"HEAD"}}),t("el-option",{attrs:{label:"OPTIONS",value:"OPTIONS"}}),t("el-option",{attrs:{label:"TRACE",value:"TRACE"}}),t("el-option",{attrs:{label:"CONNECT",value:"CONNECT"}})],1)],1),t("el-form-item",{attrs:{label:"URI"}},[t("el-input",{attrs:{placeholder:"URI"},model:{value:e.searchForm.uri,callback:function(t){e.$set(e.searchForm,"uri",t)},expression:"searchForm.uri"}})],1),t("el-form-item",{attrs:{label:"路由"}},[t("el-input",{attrs:{placeholder:"路由"},model:{value:e.searchForm.route,callback:function(t){e.$set(e.searchForm,"route",t)},expression:"searchForm.route"}})],1),t("el-form-item",{attrs:{label:"任意角色"}},[t("el-input",{attrs:{placeholder:"角色"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addTag(0)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.delTag(0)}},model:{value:e.currentAnyRole,callback:function(t){e.currentAnyRole=t},expression:"currentAnyRole"}}),e._l(e.searchForm.anyRole,(function(s){return t("el-tag",{key:s,attrs:{closable:"","disable-transitions":!1},on:{close:function(t){return e.handleCloseTag(e.item,0)}}},[e._v(e._s(s))])}))],2),t("el-form-item",{attrs:{label:"必有角色"}},[t("el-input",{attrs:{placeholder:"角色"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addTag(2)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.delTag(2)}},model:{value:e.currentMustRole,callback:function(t){e.currentMustRole=t},expression:"currentMustRole"}}),e._l(e.searchForm.mustRole,(function(s){return t("el-tag",{key:s,attrs:{closable:"","disable-transitions":!1},on:{close:function(t){return e.handleCloseTag(e.item,2)}}},[e._v(e._s(s))])}))],2),t("el-form-item",{attrs:{label:"任意权限码"}},[t("el-input",{attrs:{placeholder:"权限码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addTag(1)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.delTag(1)}},model:{value:e.currentAnyPermission,callback:function(t){e.currentAnyPermission=t},expression:"currentAnyPermission"}}),e._l(e.searchForm.anyPermission,(function(s){return t("el-tag",{key:s,attrs:{closable:"","disable-transitions":!1},on:{close:function(t){return e.handleCloseTag(e.item,1)}}},[e._v(e._s(s))])}))],2),t("el-form-item",{attrs:{label:"必有权限码"}},[t("el-input",{attrs:{placeholder:"权限码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addTag(3)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.delTag(3)}},model:{value:e.currentMustPermission,callback:function(t){e.currentMustPermission=t},expression:"currentMustPermission"}}),e._l(e.searchForm.mustPermission,(function(s){return t("el-tag",{key:s,attrs:{closable:"","disable-transitions":!1},on:{close:function(t){return e.handleCloseTag(e.item,3)}}},[e._v(e._s(s))])}))],2),t("el-form-item",{attrs:{label:"逻辑容器走向"}},[t("el-input",{attrs:{placeholder:"逻辑容器编号",type:"number"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addTag(4)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.delTag(4)}},model:{value:e.currentLogicIndex,callback:function(t){e.currentLogicIndex=t},expression:"currentLogicIndex"}}),e._l(e.searchForm.logicIndex,(function(s){return t("el-tag",{key:s,attrs:{closable:"","disable-transitions":!1},on:{close:function(t){return e.handleCloseTag(e.item,4)}}},[e._v(e._s(s))])}))],2),t("el-form-item",{attrs:{label:"角色校验逻辑（any与must之间）"}},[t("el-select",{attrs:{placeholder:"角色校验逻辑"},model:{value:e.searchForm.roleMode,callback:function(t){e.$set(e.searchForm,"roleMode",t)},expression:"searchForm.roleMode"}},[t("el-option",{attrs:{label:"OR",value:"0"}}),t("el-option",{attrs:{label:"AND",value:"1"}})],1)],1),t("el-form-item",{attrs:{label:"权限码校验逻辑（any与must之间）"}},[t("el-select",{attrs:{placeholder:"权限码校验逻辑"},model:{value:e.searchForm.permissionMode,callback:function(t){e.$set(e.searchForm,"permissionMode",t)},expression:"searchForm.permissionMode"}},[t("el-option",{attrs:{label:"OR",value:"0"}}),t("el-option",{attrs:{label:"AND",value:"1"}})],1)],1),t("el-form-item",{attrs:{label:"上一次操作UserAccount"}},[t("el-input",{attrs:{placeholder:"上一次操作UserAccount"},model:{value:e.searchForm.operUser,callback:function(t){e.$set(e.searchForm,"operUser",t)},expression:"searchForm.operUser"}})],1),t("el-form-item",{attrs:{label:"是否仅检查登录"}},[t("el-select",{attrs:{placeholder:"是否仅检查登录"},model:{value:e.searchForm.checkLogin,callback:function(t){e.$set(e.searchForm,"checkLogin",t)},expression:"searchForm.checkLogin"}},[t("el-option",{attrs:{label:"是",value:"true"}}),t("el-option",{attrs:{label:"否",value:"false"}})],1)],1),t("el-form-item",{attrs:{label:"是否非注解鉴权"}},[t("el-select",{attrs:{placeholder:"是否非注解鉴权"},model:{value:e.searchForm.isDef,callback:function(t){e.$set(e.searchForm,"isDef",t)},expression:"searchForm.isDef"}},[t("el-option",{attrs:{label:"是",value:"true"}}),t("el-option",{attrs:{label:"否",value:"false"}})],1)],1),t("el-form-item",{attrs:{label:"是否开启"}},[t("el-select",{attrs:{placeholder:"是否开启"},model:{value:e.searchForm.isOpen,callback:function(t){e.$set(e.searchForm,"isOpen",t)},expression:"searchForm.isOpen"}},[t("el-option",{attrs:{label:"是",value:"true"}}),t("el-option",{attrs:{label:"否",value:"false"}})],1)],1),t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.search}},[e._v("新增")])],1)],1)},Ft=[],Rt={name:"auth-add",data(){return{currentAnyRole:null,currentAnyPermission:null,currentMustRole:null,currentMustPermission:null,currentLogicIndex:0,searchForm:{uri:"",serviceName:"",route:"",anyRole:[],mustRole:[],anyPermission:[],mustPermission:[],logicIndex:[0],roleMode:null,permissionMode:null,operUser:"",checkLogin:"",isDef:"",isOpen:"",current:1,pageSize:10}}},methods:{handleCloseTag(e,t=0){switch(t){case 0:return this.searchForm.anyRole.splice(this.searchForm.authRole.indexOf(e),1);case 1:return this.searchForm.anyPermission.splice(this.searchForm.anyPermission.indexOf(e),1);case 2:return this.searchForm.mustRole.splice(this.searchForm.mustRole.indexOf(e),1);case 3:return this.searchForm.mustPermission.splice(this.searchForm.mustPermission.indexOf(e),1);case 4:return this.searchForm.logicIndex.splice(this.searchForm.logicIndex.indexOf(e),1)}},addTag(e=0){switch(e){case 0:return null!=this.currentAnyRole&&""!=this.currentAnyRole&&this.searchForm.anyRole.push(this.currentAnyRole),this.currentAnyRole=null;case 1:return null!=this.currentAnyPermission&&""!=this.currentAnyPermission&&this.searchForm.anyPermission.push(this.currentAnyPermission),this.currentAnyPermission=null;case 2:return null!=this.currentMustRole&&""!=this.currentMustRole&&this.searchForm.mustRole.push(this.currentMustRole),this.currentMustRole=null;case 3:return null!=this.currentMustPermission&&""!=this.currentMustPermission&&this.searchForm.mustPermission.push(this.currentMustPermission),this.currentMustPermission=null;case 4:null!=this.currentLogicIndex&&""!=this.currentLogicIndex&&this.searchForm.logicIndex.push(this.currentLogicIndex)}},delTag(e=0){switch(e){case 0:if(null==this.currentAnyRole||""==this.currentAnyRole)return this.searchForm.anyRole.splice(this.searchForm.anyRole.length-1,1);break;case 1:if(null==this.currentAnyPermission||""==this.currentAnyPermission)return this.searchForm.anyPermission.splice(this.searchForm.anyPermission.length-1,1);break;case 2:if(null==this.currentMustRole||""==this.currentMustRole)return this.searchForm.mustRole.splice(this.searchForm.mustRole.length-1,1);break;case 3:if(null==this.currentMustPermission||""==this.currentMustPermission)return this.searchForm.mustPermission.splice(this.searchForm.mustPermission.length-1,1);break;case 4:if(null==this.currentLogicIndex)return this.searchForm.logicIndex.splice(this.searchForm.logicIndex.length-1,1)}},search(){de.add(this.searchForm).then((e=>{e.data.code||(this.$message.success(e.data.msg),this.axios.get(de.list,{params:{current:1,pageSize:10}}).then((e=>{this.$parent.$parent.datas=e.data.data.records})))}))}}},Pt=Rt,Et=(0,i.Z)(Pt,It,Ft,!1,null,"b133c522",null),Ut=Et.exports,Bt={name:"authPage",components:{authSearch:At,authAdd:Ut},data(){return{datas:null,isSearch:!1,isAdd:!1}},methods:{search(){this.isSearch^=1},insert(){this.isAdd^=1},reload(){this.axios.get(de.reload).then((e=>{e.data.code||this.$message.success("刷新成功")}))},openAuth(e){this.axios.put(de.open,{id:e.id}).then((t=>{t.data.code||(e.isOpen=!0,this.$message.success("开启鉴权成功"))}))},closeAuth(e){this.axios.put(de.close,{id:e.id}).then((t=>{t.data.code||(e.isOpen=!1,this.$message.success("关闭鉴权成功"))}))},delAuth(e){de.del({id:e.id.toString()}).then((t=>{t.data.code||(e=null,this.$message.success("删除鉴权成功"))}))}},mounted(){this.axios.get(de.list,{params:{current:1,pageSize:10}}).then((e=>{this.datas=e.data.data.records}))}},Nt=Bt,Dt=(0,i.Z)(Nt,_t,xt,!1,null,"d48371ea",null),Lt=Dt.exports,Mt=function(){var e=this,t=e._self._c;return t("div",[t("el-row",[t("el-col",{attrs:{span:10}},[t("el-input",{attrs:{placeholder:"请输入token"},model:{value:e.token,callback:function(t){e.token=t},expression:"token"}})],1),t("el-col",{attrs:{span:10}},[t("el-input",{attrs:{placeholder:"请输入primary"},model:{value:e.primary,callback:function(t){e.primary=t},expression:"primary"}})],1),t("el-col",{attrs:{span:4}},[t("el-button",{attrs:{type:"primary"},on:{click:e.page}},[e._v("查询")])],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.data,border:""}},[t("el-table-column",{attrs:{prop:"key",label:"token"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:s.row.key,placement:"top-end"}},[t("span",[e._v(e._s(`${s.row.key.substr(0,25)}.....`))])])]}}])}),t("el-table-column",{attrs:{prop:"value.primary",label:"主键"}}),t("el-table-column",{attrs:{prop:"value.status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-tag",{attrs:{type:1===s.row.value.status?"success":"danger"}},[e._v(" "+e._s(1===s.row.value.status?"在线":"下线")+" ")])]}}])}),t("el-table-column",{attrs:{prop:"value.ua_info.browserName",label:"浏览器"}}),t("el-table-column",{attrs:{prop:"value.ua_info.browserversion",label:"版本"}}),t("el-table-column",{attrs:{prop:"value.ua_info.sysName",label:"系统"}}),t("el-table-column",{attrs:{prop:"value.ua_info.deviceType",label:"设备"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-tag",{attrs:{type:"Computer"===s.row.value.ua_info.deviceType?"primary":"waring"}},[e._v(" "+e._s(s.row.value.ua_info.deviceType)+" ")])]}}])}),t("el-table-column",{attrs:{prop:"value.ua_info.isMobile",label:"是否为移动端"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-tag",{attrs:{type:s.row.value.ua_info.isMobile?"success":"danger"}},[e._v(" "+e._s(s.row.value.ua_info.isMobile?"是":"否")+" ")])]}}])}),t("el-table-column",{attrs:{prop:"value.ua_info.browserMinorVersion",label:"次版本"}}),t("el-table-column",{attrs:{prop:"value.ua_info.browserMajorVersion",label:"主版本"}}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"240"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{directives:[{name:"show",rawName:"v-show",value:s.row.value.status,expression:"scope.row.value.status"}],attrs:{size:"mini",type:"warning"},on:{click:function(t){return e.handleOffline(s.row)}}},[e._v("下线 ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:s.row.value.status,expression:"scope.row.value.status"}],attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleKick(s.row)}}},[e._v("踢出 ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:!s.row.value.status,expression:"!scope.row.value.status"}],attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleOnline(s.row)}}},[e._v("上线 ")]),t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleAnalyis(s.row)}}},[e._v("token解析 ")])]}}])})],1)],1)},Zt=[];s(82801);const zt={list:()=>Ps.get("/token/list"),page:e=>Ps.get("/token/page",{params:e}),login:e=>Ps.post("/token/login",e),deleteOrLogOut:e=>Ps.delete("/token",{data:e}),update:e=>Ps.put("/token",e),add:e=>Ps.post("/token",e),kickout:e=>Ps.post("/token/kickout",e)};var Vt={name:"tokenPage",data(){return{token:"",primary:"",data:[]}},methods:{handleAnalyis(e){alert(JSON.stringify(JSON.parse(decodeURIComponent(escape(window.atob(e.key.split(".")[1])))),null,"\t"))},handleKick(e){zt.kickout({token:e.key,primary:e.value.primary}).then((t=>{t.data.code||(e.value.status=0,this.$message.success("下线成功"))}))},handleOnline(e){zt.login({token:e.key,primary:e.value.primary}).then((t=>{t.data.code||(e.value.status=1,this.$message.success("上线成功"))}))},handleOffline(e){zt.deleteOrLogOut({token:e.key,primary:e.value.primary}).then((t=>{t.data.code||(this.data=this.data.filter((t=>t.key!==e.key)),this.$message.success("下线成功"))}))},getToken(){zt.page({token:this.token,primary:this.primary}).then((e=>{e.data.code||(this.data=e.data.data.records)}))},page(){var e=new lt;e.token=this.token,e.primary=this.primary,zt.page(e).then((e=>{e.data.code||(this.data=e.data.data.records)}))}},mounted(){this.page()}},Wt=Vt,Gt=(0,i.Z)(Wt,Mt,Zt,!1,null,"12b60338",null),jt=Gt.exports,qt=function(){var e=this,t=e._self._c;return t("el-container",[t("el-header",[t("el-switch",{staticStyle:{display:"block"},attrs:{"active-color":"#409EFF","inactive-color":"#409EFF","active-text":"树形","inactive-text":"可视化"},model:{value:e.method,callback:function(t){e.method=t},expression:"method"}})],1),t("el-main",[t("role-view",{attrs:{"view-method":e.method}})],1)],1)},Xt=[];const Ht={getRolesByTree:()=>Ps.get("/role/tree"),addRole:e=>Ps.post("/role/",e),updateRole:e=>Ps.put("/role",e),delete:e=>Ps.delete(`/role?id=${e}`)};var Qt=function(){var e=this,t=e._self._c;return t("el-row",[e.viewMethod?t("el-col",{attrs:{span:"24"}},[t("role-table")],1):t("el-col",{attrs:{span:"24"}},[t("role-ant-v")],1)],1)},Jt=[],Kt=function(){var e=this,t=e._self._c;return t("el-tree",{attrs:{data:e.data,"show-checkbox":"","node-key":"id","default-expand-all":"","expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function({node:s,data:a}){return t("el-col",{staticClass:"custom-tree-node",attrs:{span:24}},[e.validEdit(a.id)?e._e():t("span",[t("el-col",{attrs:{span:2}},[e._v(e._s(s.label))])],1),e.validInsert(a.id)||e.validEdit(a.id)?e._e():t("span",[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.doAppend(a.id)}}},[e._v(" 添加 ")]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.doEdit(a.id)}}},[e._v(" 编辑 ")]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.remove(s,a)}}},[e._v(" 删除 ")])],1),e.validInsert(a.id)||e.validEdit(a.id)?t("span",[t("el-col",{attrs:{span:6}},[t("el-input",{attrs:{placeholder:"请输入权限标识符",size:"small"},model:{value:e.userRole[a.id],callback:function(t){e.$set(e.userRole,a.id,t)},expression:"userRole[data.id]"}})],1),t("el-col",{attrs:{span:6}},[t("el-input",{attrs:{placeholder:"请输入权限名称",size:"small"},model:{value:e.roleName[a.id],callback:function(t){e.$set(e.roleName,a.id,t)},expression:"roleName[data.id]"}})],1),t("el-col",{attrs:{span:6,offset:"1"}},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.resolve(a)}}},[e._v("保存")]),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.cancel(a.id)}}},[e._v("取消")])],1)],1):e._e()])}}])})},Yt=[];class es{constructor(){(0,Le.Z)(this,"id",void 0),(0,Le.Z)(this,"isLeaf",void 0),(0,Le.Z)(this,"label",void 0),(0,Le.Z)(this,"name",void 0),(0,Le.Z)(this,"size",void 0)}}var ts={name:"roleTable",data(){return{data:null,isInsert:{},isEdit:{},userRole:{},roleName:{}}},computed:{},methods:{validInsert(e){return this.isInsert[e]},validEdit(e){return this.isEdit[e]},doAppend(e){console.log(e),this.isInsert[e]=!0},doEdit(e){console.log(e),this.isEdit[e]=!0},remove(e,t){this.$confirm("确定删除角色【"+t.label+"】吗？其所有子类角色将移动到当前角色的父类角色中","提示",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消修改"}).then((()=>{Ht.delete(t.id).then((e=>{e.data.code||(this.$message.success("删除成功"),this.$router.push("refresh"))}))})).catch((()=>{}))},addNode(e){console.log("新增节点，编号："+e),Object.assign(this.isInsert,{[e]:!1}),Object.assign(this.isEdit,{[e]:!1}),Object.assign(this.userRole,{[e]:null}),Object.assign(this.roleName,{[e]:null})},validUserRole(e){var t=this.$store.state.role.nodes,s=t.filter((t=>t.name==e));return!(s?.constructor==Object?null!=s:s.length>0)},resolve(e){e.isLeaf=!1;var t=new es,s=Object.getOwnPropertyNames(this.isInsert).length-1;t.children=[],t.id=s.toString()+1,t.label=this.roleName[e.id];var a=this.$store.state.role.nodes;this.isInsert[e.id]?Ht.addRole({fid:e.id,userRole:this.userRole[e.id],roleName:this.roleName[e.id]}).then((r=>{if(!r.data.code){this.addNode(s),t.name=this.userRole[e.id],t.isLeaf=!0,t.size=e.size-15?e.size-15:15,e.children.push(t),a.push(t);var o=a.filter((t=>t.id==e.id));console.log(o),null==o.children?o.children=[]:o.children,o.children.push(t),o.isLeaf=!1;let r=[];var n=this.$store.state.role.edges;return n.forEach((e=>{r.push({source:e.source,target:e.target})})),r.push({source:e.id,target:t.id}),this.$store.state.role.edges=r,this.main(),void this.$message.success("新增成功！")}})):this.isEdit[e.id]&&Ht.updateRole({id:e.id,userRole:this.userRole[e.id],roleName:this.roleName[e.id]}).then((e=>{if(!e.data.code)return this.$router.push("/refresh"),void this.$message.success("修改成功！");this.$message.error(e.data.msg)}))},cancel(e){this.isInsert[e]=this.isEdit[e]=!1},init(e,t,s,a){if(console.log(e),e?.constructor==Object){if(null==e.children||0==e.children.length)return Object.assign(t,{[e.id]:!1}),Object.assign(s,{[e.id]:null}),a}else if(null==e||0==e.length)return a;for(let r=0;r<e.length;++r,++a)console.log(`正在处理第${a}个数据,id=${e[r].id}...`),Object.assign(t,{[e[r].id]:!1}),Object.assign(s,{[e[r].id]:null}),this.init(e[r].children,t,s,a+1),console.log(t)},main(){let e=!0;while(e)if(this.data=this.$store.state.role.nodes.slice(0,1),this.data&&this.data[0]){e=!1;let t={},s={};console.log("进行data初始化..."),this.init(this.data,t,s,0),this.isInsert=t,this.isEdit=st.clone(t),this.roleName=s,this.userRole=st.clone(s)}}},mounted(){this.main()}},ss=ts,as=(0,i.Z)(ss,Kt,Yt,!1,null,"5763283c",null),rs=as.exports,os=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"80vw",height:"70vh"},attrs:{id:"antv"}})},ns=[],ls=s(12816),is=s.n(ls),us={name:"roleAntV",data(){return{data:{nodes:null,edges:null}}},created(){let e=!0;while(e)this.data.nodes=this.$store.state.role.nodes,this.data.edges=this.$store.state.role.edges,this.data.nodes&&this.data.edges&&(e=!1)},mounted(){this.initGraph(document.getElementById("antv"),this.data)},methods:{refreshDragedNodePosition(e){const t=e.item.get("model");t.fx=e.x,t.fy=e.y},initGraph(e,t){const s=e.scrollWidth,a=e.scrollHeight,r=new(is().Graph)({container:e,width:s,height:a,layout:{type:"force",rankdir:"UD",align:"LR"},defaultNode:{color:"#5B8FF9",labelCfg:{style:{fill:"#000",fontSize:5}}},defaultEdge:{color:"#e2e2e2"},nodeStateStyles:{hover:{fill:"#FA8C1E"}},edgeStateStyles:{hover:{stroke:"#1890ff"}},modes:{default:["drag-canvas","zoom-canvas"]}});r.read(t);const o=this;r.on("node:dragstart",(function(e){r.layout(),o.refreshDragedNodePosition(e)})),r.on("node:drag",(function(e){o.refreshDragedNodePosition(e)})),r.on("node:dragend",(function(e){e.item.get("model").fx=null,e.item.get("model").fy=null})),"undefined"!==typeof window&&(window.onresize=()=>{r&&!r.get("destroyed")&&e&&e.scrollWidth&&e.scrollHeight&&r.changeSize("antv",e.scrollHeight)})}}},cs=us,ds=(0,i.Z)(cs,os,ns,!1,null,"c94c36a4",null),ms=ds.exports,hs={name:"roleView",components:{RoleAntV:ms,RoleTable:rs},props:{viewMethod:Boolean}},ps=hs,gs=(0,i.Z)(ps,Qt,Jt,!1,null,"c8ed1a6e",null),fs=gs.exports,vs={name:"rolePage",data(){return{method:!1}},components:{RoleView:fs},methods:{reload(){Ht.getRolesByTree().then((e=>{if(e.data&&!e.data.code){let t=e.data.data.nodes,s=this.$store.state.user.roles={};for(let e=0;e<t.length;e++){let a=t[e];s[a.name]=a.label}let a=e.data.data.edges;this.$store.state.role.nodes=t,this.$store.state.role.edges=a}}))}},mounted(){this.reload()}},bs=vs,ys=(0,i.Z)(bs,qt,Xt,!1,null,"41f0b536",null),ks=ys.exports;const ws=[{path:"/dataPage",component:Ee,meta:{showInbreadcrumb:!0,title:"数据统计",mustLogin:!0}},{path:"/loginfo",component:wt,meta:{showInbreadcrumb:!0,title:"日志记录",mustLogin:!0}},{path:"/settingPage",component:We,meta:{showInbreadcrumb:!0,title:"站点设置",mustLogin:!0}},{path:"/apidoc",component:Qe,meta:{showInbreadcrumb:!0,title:"API文档",mustLogin:!0,mustAdmin:!0}},{path:"/userPage",component:ht,meta:{showInbreadcrumb:!0,title:"用户管理",mustLogin:!0,mustAdmin:!0}},{path:"/rolePage",component:ks,meta:{showInbreadcrumb:!0,title:"角色管理",mustLogin:!0,mustAdmin:!0}},{path:"/tokenPage",component:jt,meta:{showInbreadcrumb:!0,title:"Token管理",mustLogin:!0,mustAdmin:!0}},{path:"/authPage",component:Lt,meta:{showInbreadcrumb:!0,title:"鉴权中心管理",mustLogin:!0}}];var _s=function(){var e=this,t=e._self._c;return t("div")},xs=[],Cs={name:"reFresh",beforeRouteEnter(e,t,s){s((e=>{e.$router.replace(t.path)}))}},Ss=Cs,$s=(0,i.Z)(Ss,_s,xs,!1,null,"22ddce12",null),Ts=$s.exports;const Os={mode:"history",routes:[{path:"/",redirect:"/dataPage",component:Ee,meta:{showInbreadcrumb:!0,title:V.protectTitle(),mustLogin:!0}},{path:"/login",component:oe,meta:{showInbreadcrumb:!0,title:"用户登录"}},{path:"/manggerCenter",component:Se,meta:{showInbreadcrumb:!1,title:V.protectTitle(),mustLogin:!0},children:ws},{path:"/refresh",component:Ts},{path:"/*",component:()=>s.e(530).then(s.bind(s,72530)),meta:{title:"Not Found"}}]};var As=Os;const Is=new W.Z(As);a["default"].use(W.Z),Is.beforeEach(((e,t,s)=>{e.meta.title?document.title=V.protectTitle()+e.meta.title:document.title=V.protectTitle(),"/login"==e.path?null==sessionStorage.getItem("loginStatus")?(L.state.user.token=void 0,s()):s("/datapage"):1==e.meta.mustLogin?null==sessionStorage.getItem("loginStatus")?Ps.get(x.getInfo).then((t=>{null==t.data.data||t.data.code?(console.log(t.data.message),sessionStorage.removeItem("loginStatus"),s(`/login?redirect=${e.path}`)):(a["default"].prototype.$loginStatus=t.data.data,sessionStorage.setItem("loginStatus",JSON.stringify(t.data.data)),console.log(a["default"].prototype.$loginStatus),Ht.getRolesByTree().then((e=>{if(e.data&&!e.data.code){let t=e.data.data.nodes,s=L.state.user.roles={};for(let e=0;e<t.length;e++){let a=t[e];s[a.name]=a.label}}})),s())})).catch((()=>{s(`/login?redirect=${e.path}`)})):(a["default"].prototype.$loginStatus=JSON.parse(sessionStorage.getItem("loginStatus")),s()):s()}));const Fs=W.Z.prototype.push;W.Z.prototype.push=function(e){return Fs.call(this,e).catch((e=>e))};var Rs=Is,Ps=b.Z.create();Ps.defaults.baseURL=k,Ps.defaults.crossDomain=!0,Ps.defaults.withCredentials=!0,Ps.interceptors.request.use((e=>{var t=(new Date).getTime(),s="default";L.state.user.token!=s&&(s=L.state.user.token),e.headers["Authorization"]="Bearer "+s,e.headers["Uuid"]=L.state.user.uuid,e.headers["X-Ca-Timestamp"]=t;var a=S().MD5(Math.floor(9e5*Math.random()+1e5).toString()+s),r=a.toString().substring(0,10*Math.random()+5);return e.headers["X-Ca-Nonce"]=r,e.headers["X-Ca-Sign"]=T.signByRequest(r,t),e})),Ps.interceptors.response.use((e=>(e.data.code&&40==Math.floor(e.data.code)&&4e4!=e.data.code?(sessionStorage.removeItem("loginStatus"),sessionStorage.removeItem("store"),L.state.user.token="",L.state.user.uuid="",Rs.push(`/login?redirect=${location.href.substring(8+location.href.substring(8).indexOf("/"))}`)):e.data.code&&(new a["default"]).$message.error(e.data.message),e)),(e=>{if(e&&e.response&&e.response.status&&e.response.data&&e.response.data.code&&4e4!=e.response.data.code)return(new a["default"]).$message.error(e.response.data.message),sessionStorage.removeItem("loginStatus"),sessionStorage.removeItem("store"),L.state.user.token="",L.state.user.uuid="",Rs.push(`/login?redirect=${location.href.substring(8+location.href.substring(8).indexOf("/"))}`),Object.assign(e,{data:e.response}),Promise.resolve(e)})),a["default"].prototype.$wow=v(),a["default"].config.silent=!0,a["default"].use(m()),a["default"].use(g),a["default"].prototype.axios=Ps,a["default"].config.productionTip=!1,a["default"].prototype.resetSetItem=function(e,t){switch(e){case"doclist":case"updateText":var s=document.createEvent("StorageEvent"),a={setItem:function(e,t){sessionStorage.setItem(e,t),s.initStorageEvent("setItem",!1,!1,e,null,t,null,null),window.dispatchEvent(s)}};return a.setItem(e,t);default:break}},a["default"].config.productionTip=!1,new a["default"]({router:Rs,store:L,render:e=>e(c)}).$mount("#app")},42480:function(){}},t={};function s(a){var r=t[a];if(void 0!==r)return r.exports;var o=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(o.exports,o,o.exports,s),o.loaded=!0,o.exports}s.m=e,function(){s.amdO={}}(),function(){var e=[];s.O=function(t,a,r,o){if(!a){var n=1/0;for(c=0;c<e.length;c++){a=e[c][0],r=e[c][1],o=e[c][2];for(var l=!0,i=0;i<a.length;i++)(!1&o||n>=o)&&Object.keys(s.O).every((function(e){return s.O[e](a[i])}))?a.splice(i--,1):(l=!1,o<n&&(n=o));if(l){e.splice(c--,1);var u=r();void 0!==u&&(t=u)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[a,r,o]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.f={},s.e=function(e){return Promise.all(Object.keys(s.f).reduce((function(t,a){return s.f[a](e,t),t}),[]))}}(),function(){s.u=function(e){return"js/"+e+".b8368a66.js"}}(),function(){s.miniCssF=function(e){}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="XXXXManngerSystem:";s.l=function(a,r,o,n){if(e[a])e[a].push(r);else{var l,i;if(void 0!==o)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==a||d.getAttribute("data-webpack")==t+o){l=d;break}}l||(i=!0,l=document.createElement("script"),l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.setAttribute("data-webpack",t+o),l.src=a),e[a]=[r];var m=function(t,s){l.onerror=l.onload=null,clearTimeout(h);var r=e[a];if(delete e[a],l.parentNode&&l.parentNode.removeChild(l),r&&r.forEach((function(e){return e(s)})),t)return t(s)},h=setTimeout(m.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=m.bind(null,l.onerror),l.onload=m.bind(null,l.onload),i&&document.head.appendChild(l)}}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){s.p="/"}(),function(){var e={143:0};s.f.j=function(t,a){var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)a.push(r[2]);else{var o=new Promise((function(s,a){r=e[t]=[s,a]}));a.push(r[2]=o);var n=s.p+s.u(t),l=new Error,i=function(a){if(s.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var o=a&&("load"===a.type?"missing":a.type),n=a&&a.target&&a.target.src;l.message="Loading chunk "+t+" failed.\n("+o+": "+n+")",l.name="ChunkLoadError",l.type=o,l.request=n,r[1](l)}};s.l(n,i,"chunk-"+t,t)}},s.O.j=function(t){return 0===e[t]};var t=function(t,a){var r,o,n=a[0],l=a[1],i=a[2],u=0;if(n.some((function(t){return 0!==e[t]}))){for(r in l)s.o(l,r)&&(s.m[r]=l[r]);if(i)var c=i(s)}for(t&&t(a);u<n.length;u++)o=n[u],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(c)},a=self["webpackChunkXXXXManngerSystem"]=self["webpackChunkXXXXManngerSystem"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[998],(function(){return s(68246)}));a=s.O(a)})();
//# sourceMappingURL=app.f7d76cd7.js.map